<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

    <title>Time Q (Offline App)</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>

<body>
    <main class="container">
        <header>
            <h1><i class="fas fa-stopwatch"></i>Time Q</h1>
            <div id="header-controls">
                <button id="shortcut-settings-btn" class="icon-btn"><i class="fas fa-keyboard"></i>ショートカット</button>
                <button id="history-log-btn" class="icon-btn"><i class="fas fa-history"></i>更新履歴</button>
                <button id="theme-toggle-btn" class="icon-btn"><i class="fas fa-moon"></i></button>
            </div>
        </header>

        <div id="home-screen">
            <h2 id="home-title"></h2>
            <div id="electron-home" class="hidden">
                <div class="button-group">
                    <button id="start-server-btn"><i class="fas fa-server"></i> サーバーとして起動</button>
                    <button id="join-as-client-btn"><i class="fas fa-sign-in-alt"></i> クライアントとして参加</button>
                </div>
            </div>
            <div id="server-info" class="hidden">
                <div id="connection-area">
                    <p>クライアントの接続を待っています...</p>
                    <div class="qr-code-container">
                        <img id="server-qr-code-image" src="" alt="QR Code">
                        <p id="server-url-text"></p>
                    </div>
                </div>
            </div>
            <div id="browser-home" class="hidden">
                <div class="join-room-container">
                    <input type="text" id="ip-input" placeholder="サーバーPCのIPアドレスを入力">
                    <button id="join-director-btn"><i class="fas fa-user-tie"></i> ディレクターとして参加</button>
                    <button id="join-personality-btn"><i class="fas fa-user"></i> パーソナリティとして参加</button>
                </div>
            </div>
        </div>

        <div id="director-screen" class="main-layout hidden">
            <div class="left-panel">
                <h2><i class="fas fa-list-ol"></i>進行表</h2>
                <div id="director-cue-sheet" class="cue-sheet-area"></div>
                <div class="cue-sheet-controls">
                    <button id="prev-item-btn"><i class="fas fa-backward"></i> 前へ</button>
                    <button id="next-item-btn">次へ <i class="fas fa-forward"></i></button>
                </div>
                <div class="director-footer-controls">
                    <button id="download-log-btn" class="icon-btn"><i class="fas fa-download"></i> ログ保存</button>
                </div>
            </div>
            <div class="right-panel">
                <div id="timer-display" class="timer-display-area">
                    <div>
                        <div id="program-timer-label" class="timer-label">番組残り時間</div>
                        <div id="program-timer" class="timer-clock">00:00:00</div>
                    </div>
                    <div class="segment-timer-area">
                        <div id="segment-timer-label" class="timer-label">コーナー残り時間</div>
                        <div id="segment-timer" class="segment-timer-clock">+00:00</div>
                    </div>
                    <div class="time-diff-area">
                        <div class="timer-label">押し/巻き</div>
                        <div id="time-diff" class="time-diff-clock">+00:00</div>
                    </div>
                </div>
                <div class="main-controls">
                    <button id="play-pause-btn"><i class="fas fa-play"></i> START</button>
                    <button id="fullscreen-btn" class="icon-btn" style="width: 100%; margin-top: 5px;"><i
                            class="fas fa-expand"></i> 全画面表示</button>
                </div>

                <div class="sub-heading-with-button">
                    <h2><i class="fas fa-pencil-alt"></i>手書き指示</h2>
                    <div id="ack-indicator">了解！</div>
                </div>
                <div id="handwriting-wrapper">
                    <canvas id="handwriting-canvas"></canvas>
                </div>
                <div id="canvas-controls">
                    <button id="clear-canvas-btn" class="icon-btn danger-btn"><i class="fas fa-trash"></i> 消去</button>
                </div>

                <div class="sub-heading-with-button">
                    <h2><i class="fas fa-bolt"></i>プリセットメッセージ</h2>
                    <button id="open-preset-settings-btn" class="icon-btn"><i class="fas fa-cog"></i> 設定</button>
                </div>
                <div id="preset-buttons-area"></div>

                <div class="right-panel-footer">
                    <button id="end-program-btn" class="danger-btn"><i class="fas fa-stop-circle"></i> 番組終了</button>
                </div>
            </div>
        </div>

        <div id="personality-screen" class="main-layout hidden">
            <div class="left-panel">
                <div id="timer-display-personality" class="timer-display-area">
                    <div>
                        <div id="program-timer-label-personality" class="timer-label">番組残り時間</div>
                        <div id="program-timer-personality" class="timer-clock">00:00:00</div>
                    </div>
                    <div class="segment-timer-area">
                        <div id="segment-timer-label-personality" class="timer-label">コーナー残り時間</div>
                        <div id="segment-timer-personality" class="segment-timer-clock">+00:00</div>
                    </div>
                    <div class="time-diff-area">
                        <div class="timer-label">押し/巻き</div>
                        <div id="time-diff-personality" class="time-diff-clock">+00:00</div>
                    </div>
                </div>
                <h2><i class="fas fa-list-ol"></i>進行表</h2>
                <div id="personality-cue-sheet" class="cue-sheet-area"></div>
            </div>
            <div class="right-panel">
                <h2><i class="fas fa-info-circle"></i>指示</h2>
                <div id="instruction-display-area">
                    <p>指示を待っています...</p>
                </div>
                <div class="ack-button-area">
                    <button id="ack-btn"><i class="fas fa-check"></i> 了解</button>
                </div>
            </div>
        </div>
    </main>

    <div id="program-settings-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2><i class="fas fa-cogs"></i>番組設定</h2>
            <label for="program-title">番組タイトル</label>
            <input type="text" id="program-title" value="マイラジオプログラム">
            <label for="program-duration">番組全体の時間（分）</label>
            <input type="number" id="program-duration" value="30" min="1">

            <div id="cue-sheet-builder">
                <h3>進行表の作成</h3>
                <div class="template-management">
                    <select id="template-select">
                        <option value="">テンプレートを選択</option>
                    </select>
                    <button id="load-template-btn" class="icon-btn"><i class="fas fa-folder-open"></i>読込</button>
                    <button id="save-template-btn" class="icon-btn"><i class="fas fa-save"></i>保存</button>
                    <button id="delete-template-btn" class="icon-btn danger-btn"><i class="fas fa-trash"></i></button>
                </div>
                <div class="cue-sheet-header">
                    <div class="col-title">コーナー名</div>
                    <div class="col-min">分</div>
                    <div class="col-sec">秒</div>
                    <div class="col-type">タイプ</div>
                    <div class="col-action"></div>
                </div>
                <div id="cue-sheet-rows-container"></div>
                <button id="add-cue-row-btn"><i class="fas fa-plus"></i> 行を追加</button>
            </div>
            <button id="start-program-btn"><i class="fas fa-rocket"></i> この内容で番組を開始</button>
        </div>
    </div>

    <div id="history-log-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2><i class="fas fa-history"></i>更新履歴</h2>
            <ul id="history-log-list"></ul>
        </div>
    </div>

    <div id="preset-settings-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2><i class="fas fa-cog"></i>プリセットメッセージ設定</h2>
            <p>カンマ区切りでメッセージを入力してください。</p>
            <textarea id="preset-messages-input" rows="5"></textarea>
            <button id="save-preset-messages-btn"><i class="fas fa-save"></i> 保存する</button>
        </div>
    </div>

    <div id="custom-prompt-modal" class="modal hidden">
        <div class="prompt-content">
            <h3 id="prompt-title"></h3>
            <input type="text" id="prompt-input">
            <div class="prompt-buttons">
                <button id="prompt-cancel-btn">キャンセル</button>
                <button id="prompt-ok-btn">OK</button>
            </div>
        </div>
    </div>

    <div id="shortcut-settings-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2><i class="fas fa-keyboard"></i>ショートカットキー設定</h2>
            <p>設定したい項目のボックスをクリックしてから、割り当てたいキーを押してください。</p>
            <div id="shortcut-list-container"></div>
            <button id="save-shortcuts-btn" style="width: 100%; margin-top: 20px;"><i class="fas fa-save"></i>
                この設定を保存</button>
        </div>
    </div>

    <div id="preset-message-display" class="hidden"></div>

    <script src="signature_pad.js"></script>
    <script src="script.js"></script>

</body>

</html>